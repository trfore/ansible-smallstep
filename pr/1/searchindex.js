Search.setIndex({"alltitles": {"1. Download and Add CA Certificate to Trust Store": [[2, "download-and-add-ca-certificate-to-trust-store"]], "2. Request SSH User Certificate": [[2, "request-ssh-user-certificate"]], "3. Configure User\u2019s SSH client": [[2, "configure-user-s-ssh-client"]], "4. Test the Connection": [[2, "test-the-connection"]], "Additional Guides and References": [[0, "additional-guides-and-references"], [1, "additional-guides-and-references"], [2, "additional-guides-and-references"]], "CA Directory Layout": [[0, "ca-directory-layout"], [0, "id3"]], "CA Server (x509 Certificates)": [[0, "ca-server-x509-certificates"]], "CA Server (x509 and SSH Certificates)": [[0, "ca-server-x509-and-ssh-certificates"]], "Collection links": [[5, "collection-links"], [6, "collection-links"], [7, "collection-links"], [8, "collection-links"], [9, "collection-links"], [10, "collection-links"]], "Configure Servers to Use SSH Certificates": [[2, "configure-servers-to-use-ssh-certificates"]], "Configure User Machine for SSH User Certificate": [[2, "configure-user-machine-for-ssh-user-certificate"]], "Description": [[4, "description"]], "Directory Layout": [[1, "directory-layout"], [2, "directory-layout"]], "Entry point certs \u2013 Request x509 certificates from the step CA server": [[7, "entry-point-certs-request-x509-certificates-from-the-step-ca-server"]], "Entry point initialize \u2013 Initializes a public key infrastructure (PKI) to be used by step CA": [[6, "entry-point-initialize-initializes-a-public-key-infrastructure-pki-to-be-used-by-step-ca"]], "Entry point main \u2013 Add provisioners to Step CA": [[9, "entry-point-main-add-provisioners-to-step-ca"]], "Entry point main \u2013 Download and add the CA root certificate to trust stores": [[5, "entry-point-main-download-and-add-the-ca-root-certificate-to-trust-stores"]], "Entry point main \u2013 Install Step CLI": [[8, "entry-point-main-install-step-cli"]], "Entry point main \u2013 Install Step Certificates": [[6, "entry-point-main-install-step-certificates"]], "Entry point main \u2013 Request SSH Certificate from step CA Server": [[10, "entry-point-main-request-ssh-certificate-from-step-ca-server"]], "Entry point main \u2013 Request x509 certificates from the step CA server and automatically renew them": [[7, "entry-point-main-request-x509-certificates-from-the-step-ca-server-and-automatically-renew-them"]], "Entry point renewal \u2013 Create systemd timers to renew x509 certificates": [[7, "entry-point-renewal-create-systemd-timers-to-renew-x509-certificates"]], "Entry point service \u2013 Create systemd service for `step-ca`": [[6, "entry-point-service-create-systemd-service-for-step-ca"]], "Index of all Collection Environment Variables": [[3, "index-of-all-collection-environment-variables"]], "Multiple Certificates": [[1, "multiple-certificates"]], "OAuth2 Credentials": [[0, "oauth2-credentials"], [2, "oauth2-credentials"]], "OIDC Provisioner: Email Addresses With Special Characters": [[2, "oidc-provisioner-email-addresses-with-special-characters"]], "Parameters": [[5, "parameters"], [6, "parameters"], [6, "id2"], [6, "id4"], [7, "parameters"], [8, "parameters"], [9, "parameters"], [10, "parameters"]], "Playbook": [[0, "playbook"], [0, "id2"], [1, "playbook"], [1, "id1"], [2, "playbook"]], "Plugin Index": [[4, "plugin-index"]], "Principals": [[2, "principals"]], "Role Index": [[4, "role-index"]], "Scenario Guides": [[4, "scenario-guides"]], "Setup Servers and User Machines to Use SSH Certificates": [[2, "setup-servers-and-user-machines-to-use-ssh-certificates"]], "Setup a Step CA Server (Non-Production)": [[0, "setup-a-step-ca-server-non-production"]], "Setup a Step Client (Machine / Server)": [[1, "setup-a-step-client-machine-server"]], "Single Certificate": [[1, "single-certificate"]], "Step CA Directory Layout": [[2, "step-ca-directory-layout"]], "Synopsis": [[5, "synopsis"], [6, "synopsis"], [6, "id1"], [6, "id3"], [7, "synopsis"], [7, "id1"], [7, "id2"], [8, "synopsis"], [9, "synopsis"], [10, "synopsis"]], "Trfore.Smallstep": [[4, "trfore-smallstep"]], "Variable Files": [[0, "variable-files"], [0, "id1"]], "trfore.smallstep.step_ca role \u2013 Install Step Certificates": [[6, "trfore-smallstep-step-ca-role-install-step-certificates"]], "trfore.smallstep.step_ca_cert role \u2013 Download and add the CA root certificate to trust stores": [[5, "trfore-smallstep-step-ca-cert-role-download-and-add-the-ca-root-certificate-to-trust-stores"]], "trfore.smallstep.step_cert role \u2013 Request x509 certificates from the step CA server and automatically renew them": [[7, "trfore-smallstep-step-cert-role-request-x509-certificates-from-the-step-ca-server-and-automatically-renew-them"]], "trfore.smallstep.step_cli role \u2013 Install Step CLI": [[8, "trfore-smallstep-step-cli-role-install-step-cli"]], "trfore.smallstep.step_provisioner role \u2013 Add provisioners to Step CA": [[9, "trfore-smallstep-step-provisioner-role-add-provisioners-to-step-ca"]], "trfore.smallstep.step_ssh role \u2013 Request SSH Certificate from step CA Server": [[10, "trfore-smallstep-step-ssh-role-request-ssh-certificate-from-step-ca-server"]]}, "docnames": ["docsite/guide_ca_nonproduction", "docsite/guide_client", "docsite/guide_ssh", "environment_variables", "index", "step_ca_cert_role", "step_ca_role", "step_cert_role", "step_cli_role", "step_provisioner_role", "step_ssh_role"], "envversion": {"sphinx": 61, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1}, "filenames": ["docsite/guide_ca_nonproduction.rst", "docsite/guide_client.rst", "docsite/guide_ssh.rst", "environment_variables.rst", "index.rst", "step_ca_cert_role.rst", "step_ca_role.rst", "step_cert_role.rst", "step_cli_role.rst", "step_provisioner_role.rst", "step_ssh_role.rst"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [1, 5], "0": [4, 5, 6, 7, 8, 9, 10], "00": 10, "000000": 0, "02": 10, "04": 1, "07": 10, "1": [1, 4, 5, 6, 7, 8, 9, 10], "10": 1, "12": 1, "123": 0, "14": 4, "15": [2, 6, 8, 10], "168h": 0, "17": 1, "18": 1, "1min": 1, "2": 4, "24h": [7, 9], "30": 10, "3339": 7, "3min": 1, "443": 6, "456": 0, "46": 1, "48": 1, "48h": 0, "66": 10, "7": [6, 8], "72h": 9, "A": [0, 1, 2], "And": 2, "For": [0, 2, 7], "If": [2, 6, 8], "It": [2, 5, 6, 7, 8, 9, 10], "No": 3, "On": 7, "One": [7, 10], "The": [0, 1, 2, 3, 6, 7, 10], "There": 4, "These": [0, 4], "To": [2, 5, 6, 7, 8, 9, 10], "__pkg_extens": [6, 8], "_amd64": [6, 8], "accept": 10, "access": [0, 2], "account": 0, "acm": [0, 1, 7, 9], "activ": 1, "add": [0, 1, 4, 10], "addit": [7, 10], "addition": [2, 6], "address": [1, 6, 7, 10], "after": [1, 7], "all": 7, "allow": 9, "alreadi": [1, 2], "also": [2, 10], "altern": 7, "an": [1, 2, 9, 10], "ansibl": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10], "ansible_default_ipv4": 1, "ansible_fqdn": [1, 7, 10], "ansible_vault_kei": 0, "api": 0, "app": [0, 2], "approach": 1, "ar": [0, 3, 4, 6], "assign": [0, 6], "assum": [1, 2], "attempt": [1, 7], "audienc": 9, "authent": [2, 7, 10], "author": [0, 2, 4], "auto": 2, "automat": [1, 4, 10], "avail": [0, 1], "basi": 10, "becom": [0, 1, 2], "been": 3, "behavior": 1, "below": [0, 2], "beyond": [2, 6], "bin": 8, "binari": 8, "boolean": [5, 6, 7, 9], "bootstrap": 2, "both": 2, "bug": [4, 5, 6, 7, 8, 9, 10], "builtin": 1, "ca": [1, 4, 8], "ca_": 6, "ca_client": [1, 2], "ca_fingerprint": [1, 2], "ca_serv": 0, "ca_url": 2, "can": [1, 6, 8], "cannot": 7, "central": 2, "cert": [0, 1, 2, 9], "certif": [4, 9], "changed_when": 1, "check": [5, 6, 7, 8, 9, 10], "checksum": [6, 8], "choic": [5, 6, 7, 9], "claim": 9, "cli": [1, 4], "cli_": 8, "client": [0, 4, 7, 8], "client01": 7, "client_id": [0, 9], "client_secret": [0, 9], "collect": [2, 4], "com": [0, 1, 2, 4, 6, 7, 8, 10], "command": 1, "comment": [5, 6, 7, 8, 9, 10], "common": 7, "complet": [0, 1], "config": [0, 2], "config_endpoint": [0, 9], "configur": [0, 1, 3, 5, 6, 7, 9, 10], "contain": [2, 5, 6, 7, 9, 10], "control": 2, "controlmast": 2, "controlpath": 2, "controlpersist": 2, "core": [3, 4, 5, 6, 7, 8, 9, 10], "creat": [0, 1, 2, 4, 9], "crt": [0, 1, 2, 9], "current": 2, "custom": 6, "dai": 10, "daili": 10, "databas": 5, "db": 0, "declar": 3, "decret": 9, "decrypt": 6, "default": [0, 1, 2, 5, 6, 7, 8, 9, 10], "defin": 3, "demonstr": [0, 1, 2], "devic": 6, "dictionari": [7, 9], "disabl": 1, "disk": [0, 6], "dn": 7, "do": [1, 2], "doc": [0, 2], "docker": [1, 7], "document": [3, 4], "doe": 2, "domain": [0, 9], "download": [1, 4, 6, 8], "drive": 6, "durat": [7, 9], "e": [0, 1, 2, 6, 7, 8, 9, 10], "each": 7, "ecdsa": 2, "element": [7, 9], "email": 9, "empti": [6, 8], "enabl": [6, 7, 9], "encrypt": [0, 2, 6], "est": 10, "etc": [0, 1, 2, 5, 6, 7, 9, 10], "exampl": [0, 1, 2, 7, 10], "example_root_ca_": 2, "exce": [7, 10], "exist": 6, "expir": [9, 10], "extern": 0, "extract": 1, "failed_when": 1, "fals": [1, 5, 6, 7, 9], "featur": [4, 5, 6, 7, 8, 9, 10], "file": [1, 2, 6, 7, 9], "fingerprint": [1, 2, 5], "firefox": 5, "first": 10, "folder": [5, 6, 7, 9, 10], "follow": [0, 1, 2, 3, 6], "fore": 4, "form": [0, 6], "format": 9, "fqdn": [1, 10], "fri": 1, "from": [0, 1, 2, 4, 6], "full": 2, "g": [0, 1, 2, 6, 7, 8, 9, 10], "galaxi": [5, 6, 7, 8, 9, 10], "gather_fact": [0, 1, 2], "gcp": 0, "gener": [0, 2, 4, 6, 10], "get": 1, "github": [0, 1, 2, 4, 6, 8], "global": 1, "gmail": 0, "googl": [0, 2], "grep": [2, 7], "group": 1, "group_var": [0, 1, 2], "h": 2, "ha": 2, "have": [3, 10], "home": 2, "host": [0, 1, 2, 7, 10], "host01": 1, "hostvar": 1, "how": [0, 1, 2], "howev": [0, 6], "http": [0, 1, 2, 4, 6, 8], "i": [0, 1, 2, 5, 6, 7, 8, 9, 10], "id": [2, 9], "ident": [0, 2], "idp": 0, "import": [0, 1, 6, 7], "includ": [2, 5, 6, 7, 8, 9, 10], "inform": 1, "infrastructur": 4, "initi": 10, "inspect": 2, "instal": [0, 1, 2, 4, 5, 7, 9, 10], "instruct": 2, "intend": 9, "intermedi": 6, "intermediate_ca": 0, "intermediate_ca_kei": 0, "ip": [1, 7, 10], "issu": [0, 2, 4, 5, 6, 7, 8, 9, 10], "its": [2, 10], "java": 5, "jordan": 2, "jordando": 2, "json": [0, 2], "jwk": [2, 6, 10], "jwk_name": 2, "kei": [0, 1, 2, 4, 5, 7, 10], "keyregistri": 0, "known": [0, 2], "known_host": [0, 2], "last": 1, "latest": [6, 8], "left": 1, "lifetim": 10, "like": 0, "link": [0, 1, 2], "list": [0, 1, 2, 5, 6, 7, 8, 9, 10], "listen": 6, "live": 2, "local": [0, 2, 6, 7], "lock": 0, "log": [0, 6], "login": 2, "machin": [0, 4], "manag": [6, 8], "manifest": 0, "mask": [0, 6], "match": [1, 2, 7], "max": [7, 9], "minim": 2, "move": 6, "multipl": 2, "n": 1, "name": [0, 1, 2, 6, 7, 9, 10], "need": [1, 2], "new": [6, 8, 9, 10], "newer": 4, "next": [0, 1], "nistp256": 2, "non": [1, 2, 4, 6], "not_aft": 7, "note": [2, 7], "nss": 5, "oauth": [0, 2], "obtain": 9, "oidc": [0, 9], "one": 2, "onli": [0, 1, 2, 6], "openid": 0, "openssh": 2, "option": [2, 5, 10], "overridden": [6, 8], "p": 2, "packag": [6, 8], "pair": 10, "part": [5, 6, 7, 8, 9, 10], "pass": 1, "password": [0, 2, 6, 10], "password01": 0, "password02": [0, 2], "path": [0, 1, 2, 5, 6, 7, 8, 9, 10], "pem": [2, 6, 9], "perform": 0, "period": 2, "pki": [1, 4], "playbook": [5, 6, 7, 8, 9, 10], "plugin": 3, "possibl": 6, "present": 0, "primari": 10, "principl": [2, 10], "privat": 0, "product": [1, 2, 4, 6], "production": 6, "provid": [0, 2, 10], "provis": 9, "provision": [0, 1, 4, 6, 7, 10], "proxi": [0, 2, 6, 8], "pub": [0, 2], "public": 4, "r": 2, "raw": 2, "rc": 1, "read": [0, 6], "recommend": 2, "redirect": 2, "regist": 1, "releas": [6, 8], "remot": 2, "remov": 6, "renew": [1, 2, 4, 9, 10], "renewal_after_expiri": [0, 9], "report": [4, 5, 6, 7, 8, 9, 10], "repositori": [4, 5, 6, 7, 8, 9, 10], "request": [1, 4, 5, 6, 8, 9], "requir": [5, 6, 9, 10], "restart": [1, 7], "rfc": 7, "role": [0, 1, 2], "root": [1, 2, 4, 6, 7, 9, 10], "root_ca": [0, 1, 2, 9], "root_ca_kei": 0, "run": [0, 2, 5, 6, 7, 8, 9, 10], "san": 7, "san_0": [1, 7], "san_1": 7, "scope": [2, 6], "secret": 0, "section": [0, 2], "secur": [5, 6], "see": [0, 2], "semver": [6, 8], "sensit": [0, 6], "server": [4, 8, 9], "server01": 2, "servic": [1, 7, 10], "set": [1, 3, 7], "setup": 4, "sha2": 2, "share": 2, "short": 2, "should": 2, "singl": 2, "skip": [0, 6, 8], "smallstep": [0, 1, 2], "sourc": [4, 5, 6, 7, 8, 9, 10], "specifi": [5, 6, 7, 8, 9, 10], "ssh": [1, 4, 6, 9], "ssh_host_ca_kei": 0, "ssh_host_ecdsa_kei": 10, "ssh_user_ca_kei": 0, "ssh_user_kei": 2, "sshd_config": 0, "sshpop": [0, 2, 9, 10], "ssl": [2, 6], "stdout": 1, "step": [4, 5], "step_ca": [0, 4], "step_ca_address": 6, "step_ca_cert": [1, 2, 4], "step_ca_cert_firefox": 5, "step_ca_cert_java": 5, "step_ca_checksum": 6, "step_ca_enable_servic": [0, 6], "step_ca_fingerprint": [1, 2, 5], "step_ca_initi": [0, 6], "step_ca_nam": [0, 6], "step_ca_password": [0, 6], "step_ca_path": [0, 5, 6, 7, 9, 10], "step_ca_pkg_src": 6, "step_ca_provisioner_password": [0, 6], "step_ca_root_cert": 6, "step_ca_root_kei": 6, "step_ca_root_key_password": 6, "step_ca_ssh_mgmt": [0, 6], "step_ca_url": [1, 2, 5], "step_ca_vers": 6, "step_cert": [1, 4], "step_cert_list": [1, 7], "step_cert_renew": 7, "step_cert_renewal_restart_svc": [1, 7], "step_cli": [1, 4], "step_cli_checksum": 8, "step_cli_pkg_src": 8, "step_cli_vers": 8, "step_config": 0, "step_includ": 0, "step_provision": [0, 4], "step_ssh": [2, 4], "step_ssh_key_pair_nam": 10, "step_ssh_principal_0": 10, "step_ssh_principal_1": 10, "step_ssh_provision": [2, 10], "step_ssh_provisioner_password": [2, 10], "step_ssh_token": 10, "store": [0, 1, 4, 6, 7], "string": [5, 6, 7, 8, 9, 10], "subject": [1, 7], "submit": [4, 5, 6, 7, 8, 9, 10], "support": [2, 4], "system": [0, 1, 5, 6], "systemctl": [1, 7], "systemd": [1, 10], "task": [1, 6], "taylor": 4, "templat": [0, 7], "them": 4, "thi": [0, 1, 2, 5, 6, 7, 8, 9, 10], "thu": [1, 7], "time": [7, 10], "timer": [1, 10], "tl": 6, "token": [2, 7, 9, 10], "tpl": 0, "tracker": [4, 5, 6, 7, 8, 9, 10], "tree": 1, "trfore": [0, 1, 2], "true": [0, 1, 2, 5, 6, 7, 9], "trust": [1, 4], "two": [0, 6, 7], "txt": [0, 6, 8], "type": [0, 2, 9], "unit": [1, 6], "uri": 5, "url": [2, 6, 8, 9], "us": [0, 1, 3, 4, 5, 7, 8, 9, 10], "usb": 6, "user": [0, 1, 4, 6, 10], "usernam": 2, "usr": [2, 8], "utc": [1, 10], "v": [6, 8], "v01": 2, "valid": 9, "valu": [0, 6, 7], "var": [0, 1, 2], "variabl": [1, 6], "vars_fil": 0, "vault": [0, 6], "vault_oidc_client_id": 0, "vault_oidc_client_secret": 0, "vault_step_ca_password": 0, "vault_step_ca_provisioner_password": 0, "version": [4, 5, 6, 7, 8, 9, 10], "via": 1, "view": 7, "vlog": 0, "well": [0, 1], "when": [6, 8, 10], "whether": [5, 6, 7, 8, 9, 10], "which": 1, "within": 10, "without": 2, "word": 10, "work": 1, "workspac": [0, 2], "would": 0, "write": [0, 6], "x509": [1, 2, 4, 9], "x509_default_dur": [0, 9], "x509_max_dur": [0, 9], "x5c": 9, "x5c_root": 9, "xx": 1, "xxxx": 1, "yml": [0, 1, 2], "you": [0, 1], "yubikei": 6}, "titles": ["Setup a Step CA Server (Non-Production)", "Setup a Step Client (Machine / Server)", "Setup Servers and User Machines to Use SSH Certificates", "Index of all Collection Environment Variables", "Trfore.Smallstep", "trfore.smallstep.step_ca_cert role \u2013 Download and add the CA root certificate to trust stores", "trfore.smallstep.step_ca role \u2013 Install Step Certificates", "trfore.smallstep.step_cert role \u2013 Request x509 certificates from the step CA server and automatically renew them", "trfore.smallstep.step_cli role \u2013 Install Step CLI", "trfore.smallstep.step_provisioner role \u2013 Add provisioners to Step CA", "trfore.smallstep.step_ssh role \u2013 Request SSH Certificate from step CA Server"], "titleterms": {"": 2, "1": 2, "2": 2, "3": 2, "4": 2, "With": 2, "add": [2, 5, 9], "addit": [0, 1, 2], "address": 2, "all": 3, "automat": 7, "ca": [0, 2, 5, 6, 7, 9, 10], "cert": 7, "certif": [0, 1, 2, 5, 6, 7, 10], "charact": 2, "cli": 8, "client": [1, 2], "collect": [3, 5, 6, 7, 8, 9, 10], "configur": 2, "connect": 2, "creat": [6, 7], "credenti": [0, 2], "descript": 4, "directori": [0, 1, 2], "download": [2, 5], "email": 2, "entri": [5, 6, 7, 8, 9, 10], "environ": 3, "file": 0, "from": [7, 10], "guid": [0, 1, 2, 4], "index": [3, 4], "infrastructur": 6, "initi": 6, "instal": [6, 8], "kei": 6, "layout": [0, 1, 2], "link": [5, 6, 7, 8, 9, 10], "machin": [1, 2], "main": [5, 6, 7, 8, 9, 10], "multipl": 1, "non": 0, "oauth2": [0, 2], "oidc": 2, "paramet": [5, 6, 7, 8, 9, 10], "pki": 6, "playbook": [0, 1, 2], "plugin": 4, "point": [5, 6, 7, 8, 9, 10], "princip": 2, "product": 0, "provision": [2, 9], "public": 6, "refer": [0, 1, 2], "renew": 7, "request": [2, 7, 10], "role": [4, 5, 6, 7, 8, 9, 10], "root": 5, "scenario": 4, "server": [0, 1, 2, 7, 10], "servic": 6, "setup": [0, 1, 2], "singl": 1, "smallstep": [4, 5, 6, 7, 8, 9, 10], "special": 2, "ssh": [0, 2, 10], "step": [0, 1, 2, 6, 7, 8, 9, 10], "step_ca": 6, "step_ca_cert": 5, "step_cert": 7, "step_cli": 8, "step_provision": 9, "step_ssh": 10, "store": [2, 5], "synopsi": [5, 6, 7, 8, 9, 10], "systemd": [6, 7], "test": 2, "them": 7, "timer": 7, "trfore": [4, 5, 6, 7, 8, 9, 10], "trust": [2, 5], "us": [2, 6], "user": 2, "variabl": [0, 3], "x509": [0, 7]}})